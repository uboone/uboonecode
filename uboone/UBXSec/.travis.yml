# This will run on Travis' 'new' container-based infrastructure
sudo: false

# Blacklist
#branches:
#  except:
#    - gh-pages

# Safelist
branches:
  only:
    - master

# Environment variables
env:
  global:
    - GH_REPO_NAME: UBXSec
    - DOXYFILE: $TRAVIS_BUILD_DIR/DoxyFile
    - GH_REPO_REF: github.com/marcodeltutto/UBXSec.git

# Install dependencies
addons:
  apt:
    packages:
      - doxygen
      - doxygen-doc
      - doxygen-latex
      - doxygen-gui
      - graphviz

# Build your code e.g. by calling make
script:
  - cd $TRAVIS_BUILD_DIR
  - chmod +x generateDocumentationAndDeploy.sh
  - ./generateDocumentationAndDeploy.sh
#  - make

# Handle git submodules yourself
git:
    submodules: false
# Use sed to replace the SSH URL with the public URL, then initialize submodules
before_install:
    - sed -i 's/git@github.com:/https:\/\/github.com\//' .gitmodules
    - git submodule update --init --recursive

# Generate and deploy documentation
#after_success:
#  - cd $TRAVIS_BUILD_DIR
#  - chmod +x generateDocumentationAndDeploy.sh
#  - ./generateDocumentationAndDeploy.sh
